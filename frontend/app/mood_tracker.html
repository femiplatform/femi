<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FEMI ‚Ä¢ Mood Tracker</title>
  <link rel="stylesheet" href="../assets/app.css" />
  <style>
    .mtHero{
      background: linear-gradient(135deg, rgba(187,247,208,.45), rgba(186,230,253,.35));
      border: 1px solid rgba(17,24,39,.08);
      border-radius: 18px;
      padding: 14px;
      box-shadow: 0 14px 40px rgba(0,0,0,.06);
      backdrop-filter: blur(8px);
    }
    .mtRow{ display:grid; grid-template-columns: 1fr; gap: 10px; }
    @media (min-width: 980px){ .mtRow{ grid-template-columns: 1.15fr .85fr; } }

    .emojiGrid{
      display:grid; grid-template-columns: repeat(5, 1fr);
      gap: 10px; margin-top: 8px;
    }
    .emojiBtn{
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      padding: 12px 10px;
      border-radius: 16px;
      border: 1px solid rgba(17,24,39,.10);
      background: rgba(255,255,255,.70);
      cursor:pointer;
      transition: transform .06s ease, background .18s ease, border-color .18s ease;
      user-select:none;
      font-weight: 900;
    }
    .emojiBtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.9); }
    .emojiBtn.on{
      border-color: rgba(16,185,129,.40);
      background: rgba(236,253,245,.95);
      box-shadow: 0 10px 26px rgba(16,185,129,.12);
    }
    .emoji{ font-size: 26px; line-height: 1; }
    .emojiLbl{ font-size: 12px; opacity: .85; margin-top: 6px; text-align:center; }

    .mtKpi{
      display:grid; grid-template-columns: 1fr 1fr; gap: 10px;
    }
    .mtBig{
      font-size: 28px;
      font-weight: 900;
      background: linear-gradient(135deg, rgba(59,130,246,.88), rgba(16,185,129,.88));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      line-height: 1.1;
    }

    .qCard{ padding: 12px; }
    .qTitle{ font-weight: 900; margin-bottom: 8px; }
    .opt{
      display:flex; align-items:flex-start; gap: 10px;
      padding: 10px 10px;
      border-radius: 14px;
      border: 1px solid rgba(17,24,39,.08);
      background: rgba(255,255,255,.65);
      cursor:pointer;
      margin-bottom: 8px;
    }
    .opt:hover{ background: rgba(255,255,255,.85); }
    .opt input{ margin-top: 2px; }
    .opt span{ font-weight: 700; }
    .muted2{ opacity:.75; font-size: 12px; }

    .mtList{ display:grid; gap: 10px; margin-top: 12px; }
    .mtItem{ padding: 12px; }
    .mtItemTop{ display:flex; align-items:center; justify-content:space-between; gap: 10px; }
    .mtPill{
      display:inline-flex; align-items:center; gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(17,24,39,.08);
      background: rgba(255,255,255,.70);
      font-weight: 900;
      white-space: nowrap;
    }
    .dangerPill{ border-color: rgba(239,68,68,.25); background: rgba(254,226,226,.85); }
    .warnPill{ border-color: rgba(245,158,11,.25); background: rgba(255,237,213,.9); }
    .okPill{ border-color: rgba(34,197,94,.25); background: rgba(220,252,231,.85); }

    .mtModal{
      position: fixed; inset: 0; z-index: 60;
      display:none;
    }
    .mtModal.on{ display:block; }
    .mtBackdrop{ position:absolute; inset:0; background: rgba(2,6,23,.35); }
    .mtPanel{
      position:absolute; left:50%; top:50%;
      transform: translate(-50%,-50%);
      width: min(820px, 92vw);
      max-height: 88vh;
      overflow:auto;
      background: rgba(255,255,255,.96);
      border: 1px solid rgba(17,24,39,.10);
      border-radius: 18px;
      box-shadow: 0 18px 50px rgba(0,0,0,.18);
      backdrop-filter: blur(10px);
    }
    .mtPanelHead{
      display:flex; align-items:flex-start; justify-content:space-between; gap: 10px;
      padding: 14px;
      border-bottom: 1px solid rgba(17,24,39,.08);
      background: linear-gradient(135deg, rgba(224,242,254,.55), rgba(187,247,208,.35));
      position: sticky; top: 0;
    }
    .mtPanelTitle{ font-weight: 900; }
    .mtPanelBody{ padding: 14px; display:grid; gap: 10px; }
    .mtFoot{
      padding: 12px 14px;
      border-top: 1px solid rgba(17,24,39,.08);
      display:flex; gap: 10px; flex-wrap:wrap; justify-content:flex-end;
      background: rgba(248,250,252,.9);
      position: sticky; bottom: 0;
    }
  </style>
</head>

<body>
  <div id="app">
    <main class="container">
      <h1 class="page-title">Mood Tracker: Emoji + EPDS</h1>
      <p class="page-sub muted">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ ‡πÜ ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô EPDS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏†‡∏≤‡∏ß‡∏∞‡∏ã‡∏∂‡∏°‡πÄ‡∏®‡∏£‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏•‡∏≠‡∏î (‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ)</p>

      <div class="mtRow">
        <!-- Left: Mood quick log -->
        <div class="mtHero">
          <div class="card" style="padding:14px;background:rgba(255,255,255,.70);border:1px solid rgba(17,24,39,.08);box-shadow:0 14px 40px rgba(0,0,0,.06);">
            <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:10px;">
              <div>
                <div style="font-weight:900;font-size:16px;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                <div class="muted2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥ + ‡πÉ‡∏™‡πà‡πÇ‡∏ô‡πâ‡∏ï‡∏™‡∏±‡πâ‡∏ô ‡πÜ (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)</div>
              </div>
              <button id="btnTodayReset" class="btn btn-ghost">‡∏•‡πâ‡∏≤‡∏á</button>
            </div>

            <div class="emojiGrid" id="emojiGrid"></div>

            <div style="display:grid;gap:8px;margin-top:10px">
              <div>
                <label class="muted">‡πÇ‡∏ô‡πâ‡∏ï</label>
                <textarea id="note" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å / ‡∏ô‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠ / ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à‡∏à‡∏≤‡∏Å‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß" style="min-height:90px"></textarea>
              </div>
              <div style="display:flex;gap:10px;flex-wrap:wrap">
                <button id="btnSaveMood" class="btn btn-ok">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå</button>
                <button id="btnOpenEpsd" class="btn btn-warn">‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô EPDS</button>
              </div>
            </div>
          </div>

          <div class="card" style="padding:14px;margin-top:12px;background:rgba(255,255,255,.70);border:1px solid rgba(17,24,39,.08);box-shadow:0 14px 40px rgba(0,0,0,.06);">
            <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;">
              <div>
                <div style="font-weight:900;">‡∏™‡∏£‡∏∏‡∏õ 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
                <div class="muted2">‡∏î‡∏π‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå + ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô EPDS (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</div>
              </div>
              <button id="btnClearAll" class="btn btn-ghost">‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            </div>

            <div class="mtKpi" style="margin-top:10px">
              <div class="card-soft" style="padding:12px">
                <div class="muted">‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                <div class="mtBig" id="avgMood">-</div>
                <div class="muted2" id="avgMoodText">-</div>
              </div>
              <div class="card-soft" style="padding:12px">
                <div class="muted">EPDS ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
                <div class="mtBig" id="lastEpsd">-</div>
                <div class="muted2" id="lastEpsdText">-</div>
              </div>
            </div>

            <div id="recentList" class="mtList"></div>

            <div class="muted2" style="margin-top:8px">
              * ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á/‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢ ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏±‡∏á‡∏ß‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á ‡πÉ‡∏´‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç/‡∏™‡∏≤‡∏¢‡∏î‡πà‡∏ß‡∏ô‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
            </div>
          </div>
        </div>

        <!-- Right: Quick guidance -->
        <div>
          <div class="card" style="padding:14px">
            <div style="font-weight:900;font-size:16px">‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏ú‡∏• EPDS (‡∏™‡∏£‡∏∏‡∏õ)</div>
            <ul class="muted" style="margin:10px 0 0 18px;line-height:1.7">
              <li>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° 0‚Äì9: ‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥ (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á)</li>
              <li>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° 10‚Äì12: ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ã‡πâ‡∏≥/‡∏Ç‡∏≠‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤)</li>
              <li>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° ‚â• 13: ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°/‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç</li>
              <li><b>‡∏Ç‡πâ‡∏≠ 10 (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á)</b>: ‡∏ñ‡πâ‡∏≤‡∏ï‡∏≠‡∏ö ‚Äú‡∏°‡∏µ‚Äù ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏£ ‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</li>
            </ul>
            <div class="muted2" style="margin-top:10px">
              ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏≠‡∏≤‡∏à‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏ö‡∏ó/‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏ç‡∏≤‡∏ì‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å
            </div>
          </div>

          <div class="card" style="padding:14px;margin-top:12px">
            <div style="font-weight:900;font-size:16px">‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö‡∏î‡∏π‡πÅ‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (‡∏™‡∏±‡πâ‡∏ô ‡πÜ)</div>
            <div class="muted" style="margin-top:8px;line-height:1.7">
              <div>‚Ä¢ ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô/‡∏á‡∏µ‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™</div>
              <div>‚Ä¢ ‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏ä‡∏¥‡∏î</div>
              <div>‚Ä¢ ‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö ‡∏≠‡∏™‡∏°./‡∏£‡∏û.‡∏™‡∏ï./‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏´‡∏ß</div>
              <div>‚Ä¢ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß</div>
            </div>
          </div>
        </div>
      </div>

      <!-- EPDS Modal -->
      <div id="epsdModal" class="mtModal" aria-hidden="true">
        <div class="mtBackdrop"></div>
        <div class="mtPanel" role="dialog" aria-modal="true">
          <div class="mtPanelHead">
            <div style="min-width:0">
              <div class="mtPanelTitle">‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô EPDS (‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á)</div>
              <div class="muted2">‡∏ï‡∏≠‡∏ö‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å ‚Äú‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‚Äù</div>
            </div>
            <button class="icon-btn" id="epsdClose" aria-label="close">‚úï</button>
          </div>

          <div class="mtPanelBody">
            <div class="card-soft" style="padding:12px">
              <div class="muted2">
                ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á
                (‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏à‡∏±‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á + ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏ß‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
              </div>
            </div>

            <div id="qWrap" style="display:grid;gap:10px"></div>

            <div class="card-soft" style="padding:12px">
              <div class="muted2">
                ‡∏´‡∏≤‡∏Å‡∏ï‡∏≠‡∏ö‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 10 ‡∏ß‡πà‡∏≤ ‚Äú‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‚Äù ‡πÅ‡∏°‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
              </div>
            </div>
          </div>

          <div class="mtFoot">
            <button id="epsdReset" class="btn btn-ghost">‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
            <button id="epsdSubmit" class="btn btn-ok">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
          </div>
        </div>
      </div>

    </main>
  </div>

  <script type="module">
    import { initUserShell } from "../js/shell.js";
    import { applyI18n } from "../js/i18n.js";

    await initUserShell({ active: "tools", title: "Mood Tracker" });
    try{ applyI18n(document); }catch{}

    // ===== Storage =====
    const LS_KEY = "FEMI_MOOD_V1";

    function loadState(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        return raw ? JSON.parse(raw) : { entries: [] };
      }catch{
        return { entries: [] };
      }
    }
    function saveState(s){ localStorage.setItem(LS_KEY, JSON.stringify(s)); }

    function isoToday(){
      const d = new Date();
      const yyyy = d.getFullYear();
      const mm = String(d.getMonth()+1).padStart(2,"0");
      const dd = String(d.getDate()).padStart(2,"0");
      return `${yyyy}-${mm}-${dd}`;
    }
    function nowTs(){ return Date.now(); }

    // ===== Mood =====
    const MOODS = [
      { id: 5, emoji:"üòÑ", label:"‡∏î‡∏µ‡∏°‡∏≤‡∏Å" },
      { id: 4, emoji:"üôÇ", label:"‡∏î‡∏µ" },
      { id: 3, emoji:"üòê", label:"‡πÄ‡∏â‡∏¢ ‡πÜ" },
      { id: 2, emoji:"üòü", label:"‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡∏î‡∏µ" },
      { id: 1, emoji:"üò¢", label:"‡πÅ‡∏¢‡πà" },
    ];

    const emojiGrid = document.getElementById("emojiGrid");
    const noteEl = document.getElementById("note");
    const btnSaveMood = document.getElementById("btnSaveMood");
    const btnTodayReset = document.getElementById("btnTodayReset");
    const btnClearAll = document.getElementById("btnClearAll");

    const avgMoodEl = document.getElementById("avgMood");
    const avgMoodTextEl = document.getElementById("avgMoodText");
    const lastEpsdEl = document.getElementById("lastEpsd");
    const lastEpsdTextEl = document.getElementById("lastEpsdText");
    const recentList = document.getElementById("recentList");

    let state = loadState();
    let selectedMood = null;

    function renderEmoji(){
      emojiGrid.innerHTML = MOODS.map(m => `
        <div class="emojiBtn" data-mood="${m.id}">
          <div class="emoji">${m.emoji}</div>
          <div class="emojiLbl">${m.label}</div>
        </div>
      `).join("");

      emojiGrid.querySelectorAll(".emojiBtn").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          emojiGrid.querySelectorAll(".emojiBtn").forEach(x=>x.classList.remove("on"));
          btn.classList.add("on");
          selectedMood = Number(btn.dataset.mood);
        });
      });
    }

    function upsertTodayMood(){
      const day = isoToday();
      const note = (noteEl.value || "").trim();

      if(!selectedMood){
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å");
        return;
      }

      const existing = state.entries.find(e => e.date === day);
      if(existing){
        existing.mood = selectedMood;
        existing.note = note;
        existing.updatedAt = nowTs();
      }else{
        state.entries.push({ date: day, mood: selectedMood, note, createdAt: nowTs(), updatedAt: nowTs(), epsd: null });
      }

      // keep sorted desc
      state.entries.sort((a,b)=> (b.date.localeCompare(a.date)));
      saveState(state);
      renderAll();
      toast("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß");
    }

    function resetTodayInputs(){
      selectedMood = null;
      noteEl.value = "";
      emojiGrid.querySelectorAll(".emojiBtn").forEach(x=>x.classList.remove("on"));
    }

    btnSaveMood.addEventListener("click", upsertTodayMood);
    btnTodayReset.addEventListener("click", resetTodayInputs);
    btnClearAll.addEventListener("click", ()=>{
      if(confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?")){
        state = { entries: [] };
        saveState(state);
        renderAll();
        resetTodayInputs();
      }
    });

    // ===== EPDS =====
    // IMPORTANT: This is a scaffold. Replace question/option text with your approved EPDS version.
    // Scoring rules:
    // - Items 1,2,4: 0..3 (top option=0, bottom=3)
    // - Items 3,5-10: reverse (top option=3, bottom=0)
    const EPDS_ITEMS = [
      { n:1, key:"q1", text:"1) ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞/‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏•‡∏Å‡πÑ‡∏î‡πâ", normal:true },
      { n:2, key:"q2", text:"2) ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç/‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≤‡∏£‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≤‡∏á ‡πÜ", normal:true },
      { n:3, key:"q3", text:"3) ‡πÇ‡∏ó‡∏©‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", normal:false },
      { n:4, key:"q4", text:"4) ‡∏Å‡∏±‡∏á‡∏ß‡∏•/‡∏ï‡∏∑‡πà‡∏ô‡∏ï‡∏£‡∏∞‡∏´‡∏ô‡∏Å‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏´‡∏ï‡∏∏", normal:true },
      { n:5, key:"q5", text:"5) ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏Å‡∏•‡∏±‡∏ß/‡∏´‡∏ß‡∏≤‡∏î‡∏ú‡∏ß‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏´‡∏ï‡∏∏", normal:false },
      { n:6, key:"q6", text:"6) ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ñ‡∏≤‡πÇ‡∏ñ‡∏°‡∏à‡∏ô‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏¢‡∏≤‡∏Å", normal:false },
      { n:7, key:"q7", text:"7) ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÄ‡∏®‡∏£‡πâ‡∏≤/‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç", normal:false },
      { n:8, key:"q8", text:"8) ‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ‡∏á‡πà‡∏≤‡∏¢/‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ", normal:false },
      { n:9, key:"q9", text:"9) ‡∏ô‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏•‡∏±‡∏ö‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏∏‡∏Å‡∏Ç‡πå‡πÉ‡∏à", normal:false },
      { n:10, key:"q10", text:"10) ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á", normal:false, isRisk:true },
    ];

    const EPDS_OPTIONS = [
      "‡∏°‡∏≤‡∏Å/‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î",
      "‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏°‡∏≤‡∏Å/‡∏ö‡πà‡∏≠‡∏¢",
      "‡∏ô‡∏≤‡∏ô ‡πÜ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢",
      "‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏¢",
    ];

    const btnOpenEpsd = document.getElementById("btnOpenEpsd");
    const epsdModal = document.getElementById("epsdModal");
    const epsdClose = document.getElementById("epsdClose");
    const epsdReset = document.getElementById("epsdReset");
    const epsdSubmit = document.getElementById("epsdSubmit");
    const qWrap = document.getElementById("qWrap");

    let epsdAnswers = {}; // key -> idx(0..3)

    function openEpsd(){
      buildQuestions();
      epsdModal.classList.add("on");
      epsdModal.setAttribute("aria-hidden","false");
      document.body.classList.add("no-scroll");
    }
    function closeEpsd(){
      epsdModal.classList.remove("on");
      epsdModal.setAttribute("aria-hidden","true");
      document.body.classList.remove("no-scroll");
    }
    btnOpenEpsd.addEventListener("click", openEpsd);
    epsdClose.addEventListener("click", closeEpsd);
    epsdModal.querySelector(".mtBackdrop").addEventListener("click", closeEpsd);
    window.addEventListener("keydown", (e)=>{ if(e.key==="Escape" && epsdModal.classList.contains("on")) closeEpsd(); });

    function buildQuestions(){
      qWrap.innerHTML = EPDS_ITEMS.map(it=>{
        const name = it.key;
        return `
          <div class="card qCard">
            <div class="qTitle">${escapeHtml(it.text)}</div>
            <div class="muted2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1 ‡∏Ç‡πâ‡∏≠</div>
            <div style="margin-top:8px">
              ${EPDS_OPTIONS.map((opt, idx)=>`
                <label class="opt">
                  <input type="radio" name="${name}" value="${idx}" />
                  <span>${escapeHtml(opt)}</span>
                </label>
              `).join("")}
            </div>
          </div>
        `;
      }).join("");

      // restore existing answers if any
      qWrap.querySelectorAll('input[type="radio"]').forEach(r=>{
        r.addEventListener("change", ()=>{
          epsdAnswers[r.name] = Number(r.value);
        });
      });
    }

    epsdReset.addEventListener("click", ()=>{
      epsdAnswers = {};
      qWrap.querySelectorAll('input[type="radio"]').forEach(r=> r.checked = false);
    });

    function scoreItem(item, idx){
      // idx 0..3 (top->bottom)
      if(item.normal){
        // 0,1,2,3
        return idx;
      }
      // reverse: 3,2,1,0
      return 3 - idx;
    }

    function interpret(total, riskFlag){
      if(riskFlag){
        return { level:"urgent", pill:"‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ", cls:"dangerPill", msg:"‡∏Ç‡πâ‡∏≠ 10 ‡∏°‡∏µ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á) ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏ó‡∏±‡∏ô‡∏ó‡∏µ" };
      }
      if(total >= 13){
        return { level:"high", pill:"‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á", cls:"warnPill", msg:"‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° ‚â• 13 ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°/‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç" };
      }
      if(total >= 10){
        return { level:"mid", pill:"‡∏≠‡∏≤‡∏à‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á", cls:"warnPill", msg:"‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° 10‚Äì12 ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ã‡πâ‡∏≥/‡∏Ç‡∏≠‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤" };
      }
      return { level:"low", pill:"‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥", cls:"okPill", msg:"‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° 0‚Äì9 ‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á" };
    }

    epsdSubmit.addEventListener("click", ()=>{
      // ensure all answered
      for(const it of EPDS_ITEMS){
        if(!(it.key in epsdAnswers)){
          alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô");
          return;
        }
      }

      let total = 0;
      let riskFlag = false;
      for(const it of EPDS_ITEMS){
        const idx = epsdAnswers[it.key];
        const s = scoreItem(it, idx);
        total += s;
        if(it.isRisk && s > 0) riskFlag = true; // any non-zero after reverse scoring means some risk
      }

      const day = isoToday();
      // attach to today's entry (create if none)
      const existing = state.entries.find(e => e.date === day);
      const payload = { total, answers: epsdAnswers, riskFlag, createdAt: nowTs() };

      if(existing){
        existing.epsd = payload;
        existing.updatedAt = nowTs();
      }else{
        // If no mood yet, create entry with neutral mood
        state.entries.push({ date: day, mood: selectedMood || 3, note: (noteEl.value||"").trim(), createdAt: nowTs(), updatedAt: nowTs(), epsd: payload });
      }

      state.entries.sort((a,b)=> (b.date.localeCompare(a.date)));
      saveState(state);

      closeEpsd();
      renderAll();

      const itp = interpret(total, riskFlag);
      alert(`‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô EPDS: ${total}/30\n‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ: ${itp.pill}\n\n${itp.msg}`);
    });

    // ===== Recent list + KPIs =====
    function moodLabel(id){
      const m = MOODS.find(x=>x.id===id);
      return m ? `${m.emoji} ${m.label}` : "-";
    }

    function calcAvgMood(last7){
      if(!last7.length) return null;
      const s = last7.reduce((acc,e)=> acc + (Number(e.mood)||0), 0);
      return s / last7.length;
    }

    function renderAll(){
      state = loadState();

      // last 7 by date
      const last7 = state.entries.slice(0, 7);

      // KPIs
      const avg = calcAvgMood(last7);
      if(avg == null){
        avgMoodEl.textContent = "-";
        avgMoodTextEl.textContent = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
      }else{
        const rounded = Math.round(avg * 10) / 10;
        avgMoodEl.textContent = String(rounded);
        // map to label
        const nearest = Math.min(5, Math.max(1, Math.round(avg)));
        avgMoodTextEl.textContent = `‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á: ${moodLabel(nearest)}`;
      }

      // last EPDS
      const lastWithEpsd = state.entries.find(e => e.epsd && typeof e.epsd.total === "number");
      if(!lastWithEpsd){
        lastEpsdEl.textContent = "-";
        lastEpsdTextEl.textContent = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô";
      }else{
        const total = lastWithEpsd.epsd.total;
        const itp = interpret(total, !!lastWithEpsd.epsd.riskFlag);
        lastEpsdEl.textContent = String(total);
        lastEpsdTextEl.textContent = `${itp.pill} ‚Ä¢ ${lastWithEpsd.date}`;
      }

      // list
      recentList.innerHTML = last7.map(e=>{
        const epsd = e.epsd && typeof e.epsd.total === "number" ? e.epsd.total : null;
        const itp = epsd != null ? interpret(epsd, !!e.epsd.riskFlag) : null;
        const pill = epsd != null
          ? `<span class="mtPill ${itp.cls}">EPDS ${epsd} ‚Ä¢ ${itp.pill}</span>`
          : `<span class="mtPill">EPDS -</span>`;

        const note = e.note ? `<div class="muted2" style="margin-top:6px">‡πÇ‡∏ô‡πâ‡∏ï: ${escapeHtml(e.note)}</div>` : "";

        return `
          <div class="card mtItem">
            <div class="mtItemTop">
              <div style="min-width:0">
                <div style="font-weight:900">${e.date}</div>
                <div class="muted2">‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå: ${escapeHtml(moodLabel(e.mood))}</div>
              </div>
              ${pill}
            </div>
            ${note}
            <div class="actions" style="margin-top:10px">
              <button class="btn btn-ghost" data-del="${e.date}">‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
            </div>
          </div>
        `;
      }).join("");

      recentList.querySelectorAll("[data-del]").forEach(b=>{
        b.addEventListener("click", ()=>{
          const d = b.getAttribute("data-del");
          if(confirm(`‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${d} ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?`)){
            state.entries = state.entries.filter(x => x.date !== d);
            saveState(state);
            renderAll();
          }
        });
      });
    }

    function escapeHtml(s){
      return String(s ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // tiny toast
    let toastTimer = null;
    function toast(msg){
      clearTimeout(toastTimer);
      let el = document.getElementById("__toast");
      if(!el){
        el = document.createElement("div");
        el.id = "__toast";
        el.style.position = "fixed";
        el.style.left = "50%";
        el.style.bottom = "18px";
        el.style.transform = "translateX(-50%)";
        el.style.padding = "10px 12px";
        el.style.borderRadius = "999px";
        el.style.border = "1px solid rgba(17,24,39,.10)";
        el.style.background = "rgba(255,255,255,.92)";
        el.style.boxShadow = "0 12px 30px rgba(0,0,0,.14)";
        el.style.fontWeight = "900";
        el.style.zIndex = "80";
        document.body.appendChild(el);
      }
      el.textContent = msg;
      el.style.opacity = "1";
      toastTimer = setTimeout(()=>{ el.style.opacity = "0"; }, 1600);
    }

    // init
    renderEmoji();
    renderAll();
  </script>
</body>
</html>
