<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FEMI • Family Planning</title>
  <link rel="stylesheet" href="../assets/app.css" />
</head>
<body>
  <div id="app">
    <main class="container">
      <h1 data-i18n="fp.title">วางแผนครอบครัว</h1>
      <p class="muted" data-i18n="fp.subtitle"></p>

      <!-- Prediction summary card -->
      <div class="card" style="padding:14px">
        <div style="font-weight:900" data-i18n="fp.predTitle">คาดการณ์ (ล่าสุด)</div>
        <div class="muted" id="predText" style="margin-top:6px">-</div>
        <div id="predDetail" class="pred-detail"></div>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button class="btn btn-primary" id="btnAddCycle" data-i18n="fp.btnAddCycle"></button>
        <button class="btn btn-ghost" id="btnRecompute" data-i18n="fp.btnRecompute"></button>
      </div>

      <!-- Calendar -->
      <div class="card" style="padding:14px;margin-top:12px">
        <div class="cal-head">
          <button class="btn btn-ghost" id="btnPrev">‹</button>
          <div class="cal-title" id="calTitle">-</div>
          <button class="btn btn-ghost" id="btnNext">›</button>
        </div>

        <div class="legend">
          <span class="lg"><span class="dot period"></span><span data-i18n="fp.legend.period">ประจำเดือน</span></span>
          <span class="lg"><span class="dot fertile"></span><span data-i18n="fp.legend.fertile">ช่วงเสี่ยง</span></span>
          <span class="lg"><span class="dot ovu"></span><span data-i18n="fp.legend.ovulation">วันไข่ตก</span></span>
          <span class="lg"><span class="dot log"></span><span data-i18n="fp.legend.log">มีบันทึก</span></span>
        </div>

        <div class="cal-grid" id="calGrid"></div>
      </div>

      <div id="loading" class="muted" style="margin-top:12px" data-i18n="common.loading">กำลังโหลด…</div>
    </main>

    <!-- Daily Log Modal -->
    <div class="modal hidden" id="logModal">
      <div class="modal-card">
        <div class="modal-head">
          <div class="modal-title" data-i18n="fp.log.title">บันทึกรายวัน</div>
          <button class="icon-btn" id="btnCloseLog" aria-label="close">✕</button>
        </div>

        <div class="modal-body">
          <div class="field">
            <label data-i18n="fp.log.date">วันที่</label>
            <input id="logDateText" type="text" readonly />
          </div>

          <div class="field">
            <label data-i18n="fp.log.bleeding">เลือดออก</label>
            <select id="bleeding">
              <option value="None">None (ไม่มี)</option>
              <option value="Spotting">Spotting (กะปริบกะปรอย)</option>
              <option value="Light">Light (น้อย)</option>
              <option value="Medium">Medium (ปานกลาง)</option>
              <option value="Heavy">Heavy (มาก)</option>
            </select>
          </div>

          <div class="field">
            <label data-i18n="fp.log.mood">อารมณ์</label>
            <select id="mood">
              <option value="Good">Good (ดี)</option>
              <option value="Neutral">Neutral (ปกติ)</option>
              <option value="Bad">Bad (แย่)</option>
            </select>
          </div>

          <div class="field">
            <label data-i18n="fp.log.symptoms">อาการ</label>
            <textarea id="symptoms" rows="2" data-i18n-placeholder="fp.log.symptomsPh"></textarea>
          </div>

          <div class="field row2">
            <label class="chk"><input type="checkbox" id="hadSex" /> <span data-i18n="fp.log.hadSex">มีเพศสัมพันธ์</span></label>
            <label class="chk"><input type="checkbox" id="pillTaken" /> <span data-i18n="fp.log.pillTaken">กินยาคุม</span></label>
          </div>

          <div class="field">
            <label data-i18n="fp.log.sexProtection">การป้องกัน</label>
            <select id="sexProtection">
              <option value="None">None</option>
              <option value="Condom">Condom</option>
              <option value="Pill">Pill</option>
              <option value="IUD">IUD</option>
              <option value="Implant">Implant</option>
              <option value="Injection">Injection</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <div class="field">
            <label data-i18n="fp.log.notes">หมายเหตุ</label>
            <textarea id="notes" rows="2"></textarea>
          </div>
        </div>

        <div class="modal-foot">
          <button class="btn btn-primary" id="btnSaveLog" data-i18n="fp.log.save">บันทึก</button>
        </div>
      </div>
      <div class="backdrop" id="logBackdrop"></div>
    </div>

  </div>

  <script type="module" src="../js/pages/family_planning.js"></script>

  <style>
    .container{max-width:900px;margin:0 auto;padding:18px}
    .muted{opacity:.7}
    .card{background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:16px}
    .btn{border:0;border-radius:12px;padding:10px 12px;font-weight:900;cursor:pointer}
    .btn-primary{background:#b91c1c;color:#fff}
    .btn-ghost{background:#fff;border:1px solid rgba(0,0,0,.12)}
    .actions{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap}

    .cal-head{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .cal-title{font-weight:900}
    .legend{display:flex;flex-wrap:wrap;gap:12px;margin:10px 0 6px}
    .lg{display:flex;align-items:center;gap:6px;font-size:12px;opacity:.85}
    .dot{width:10px;height:10px;border-radius:99px;display:inline-block}
    .dot.period{background:#ef4444}
    .dot.fertile{background:#f59e0b}
    .dot.ovu{background:#8b5cf6}
    .dot.log{background:#0ea5e9}

    .cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;margin-top:8px}
    .day{border:1px solid rgba(0,0,0,.08);border-radius:12px;padding:10px 8px;min-height:54px;cursor:pointer;background:#fff}
    .day.muted{opacity:.45}
    .day .n{font-weight:900}
    .tags{display:flex;gap:4px;flex-wrap:wrap;margin-top:6px}
    .tag{width:8px;height:8px;border-radius:99px}
    .tag.period{background:#ef4444}
    .tag.fertile{background:#f59e0b}
    .tag.ovu{background:#8b5cf6}
    .tag.log{background:#0ea5e9}

    .pred-detail{margin-top:10px;display:flex;flex-direction:column;gap:6px}
    .pred-line{font-size:13px;opacity:.9}

    /* Modal */
    .modal{position:fixed;inset:0;z-index:80;display:flex;align-items:flex-end;justify-content:center}
    .modal.hidden{display:none}
    .modal-card{width:min(540px, 96vw);background:#fff;border-radius:18px;box-shadow:0 20px 60px rgba(0,0,0,.18);margin:12px;overflow:hidden}
    .modal-head{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-bottom:1px solid rgba(0,0,0,.06)}
    .modal-title{font-weight:900}
    .icon-btn{border:1px solid rgba(0,0,0,.10);background:#fff;border-radius:12px;padding:8px 10px;cursor:pointer}
    .modal-body{padding:14px;display:flex;flex-direction:column;gap:10px}
    .field label{font-size:13px;font-weight:800;display:block;margin-bottom:6px}
    input,select,textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.12)}
    .row2{display:flex;gap:12px;align-items:center}
    .chk{display:flex;gap:8px;align-items:center;font-weight:800}
    .modal-foot{padding:12px 14px;border-top:1px solid rgba(0,0,0,.06)}
    .backdrop{position:fixed;inset:0;background:rgba(0,0,0,.25);z-index:-1}
  </style>
</body>
</html>